# FreeTimeChat API Environment Configuration
# Copy this file to .env and fill in your actual values
# DO NOT commit .env file to version control

# =============================================================================
# Application
# =============================================================================

NODE_ENV=development
PORT=3001
API_URL=http://localhost:3001

# =============================================================================
# Database - Main (Authentication & Client Registry)
# =============================================================================

# Main database connection string
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?connection_limit=10&pool_timeout=20&statement_cache_size=100
# Performance parameters:
#   - connection_limit: Max connections per Prisma Client (10 dev, 20-50 prod)
#   - pool_timeout: Seconds to wait for connection from pool
#   - statement_cache_size: Number of prepared statements to cache
DATABASE_URL="postgresql://freetimechat:freetimechat_dev_password@localhost:5432/freetimechat_main?connection_limit=10&pool_timeout=20&statement_cache_size=100"

# =============================================================================
# Database - Client (Development)
# =============================================================================

# Development client database connection string
# In production, this will be dynamically generated per client
CLIENT_DATABASE_URL="postgresql://freetimechat:freetimechat_dev_password@localhost:5432/freetimechat_client_dev?connection_limit=10&pool_timeout=20&statement_cache_size=100"

# =============================================================================
# Redis Cache
# =============================================================================

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=freetimechat_redis_password
REDIS_DB=0
REDIS_TTL=3600

# =============================================================================
# JWT Authentication
# =============================================================================

# RS256 Keys (Generate with: npm run generate:keys)
# Path to RSA private key for signing JWTs
JWT_PRIVATE_KEY_PATH=./keys/private.pem

# Path to RSA public key for verifying JWTs
JWT_PUBLIC_KEY_PATH=./keys/public.pem

# JWT Expiration (in seconds or zeit/ms format)
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d

# JWT Issuer and Audience
JWT_ISSUER=freetimechat-api
JWT_AUDIENCE=freetimechat-web

# =============================================================================
# Security
# =============================================================================

# Bcrypt rounds for password hashing (10-12 recommended)
BCRYPT_ROUNDS=12

# Session secret for Express sessions
SESSION_SECRET=your-session-secret-here-change-in-production-min-32-chars

# =============================================================================
# OAuth - Google
# =============================================================================

GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=http://localhost:3001/api/v1/auth/google/callback

# =============================================================================
# Two-Factor Authentication
# =============================================================================

TWO_FACTOR_APP_NAME=FreeTimeChat
TWO_FACTOR_ISSUER=FreeTimeChat

# =============================================================================
# CORS Configuration
# =============================================================================

# Comma-separated list of allowed origins
CORS_ORIGIN=http://localhost:3000,http://localhost:3001
CORS_CREDENTIALS=true

# =============================================================================
# Rate Limiting
# =============================================================================

# Time window in milliseconds (15 minutes = 900000ms)
RATE_LIMIT_WINDOW_MS=900000

# Max requests per window
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# Logging
# =============================================================================

# Log level: error, warn, info, http, verbose, debug, silly
LOG_LEVEL=debug

# Log format: dev, combined, common, short, tiny
LOG_FORMAT=dev

# =============================================================================
# Email - Nodemailer with Mailpit (Development)
# =============================================================================

# SMTP Configuration
# For development, use Mailpit: https://github.com/axllent/mailpit
# Install: brew install mailpit (macOS) or download from GitHub releases
# Run: mailpit
# Web UI: http://localhost:8025
# SMTP: localhost:1025 (no authentication required)
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false
SMTP_USER=
SMTP_PASS=
SMTP_FROM=noreply@freetimechat.com
SMTP_FROM_NAME=FreeTimeChat

# Admin Notification Emails (comma-separated for multiple admins)
# These emails will receive notifications about account requests, etc.
ADMIN_NOTIFICATION_EMAILS=admin@freetimechat.local

# =============================================================================
# AI/LLM Integration
# =============================================================================

# -----------------------------------------------------------------------------
# LLM Configuration Encryption
# -----------------------------------------------------------------------------
# Encryption key for storing API keys in database (AES-256-CBC)
# IMPORTANT: Must be exactly 32 characters for AES-256
# Generate with: openssl rand -base64 32
LLM_CONFIG_ENCRYPTION_KEY=change-this-to-a-secure-32-char

# -----------------------------------------------------------------------------
# Environment-Based LLM Configuration (Fallback)
# -----------------------------------------------------------------------------
# These environment variables are used as fallback when no database configuration exists.
# For production, use the LLM Config API to manage provider configurations per tenant.

# LLM Provider Selection
# Options: openai, anthropic, google-gemini, perplexity, abacus-ai
# Leave blank to disable LLM and use fallback responses
LLM_PROVIDER=

# Common LLM Settings (applied to all providers)
LLM_API_KEY=
LLM_DEFAULT_MODEL=
LLM_TEMPERATURE=0.7
LLM_MAX_TOKENS=2000
LLM_BASE_URL=
LLM_ORGANIZATION=
LLM_TIMEOUT=30000

# -----------------------------------------------------------------------------
# OpenAI Configuration
# -----------------------------------------------------------------------------
# Provider: openai
# Chat Models: gpt-4, gpt-4-turbo, gpt-3.5-turbo
# Embedding Models:
#   - text-embedding-3-small (1536 dimensions, $0.00002/1K tokens)
#   - text-embedding-3-large (3072 dimensions, higher cost)
# Get API key: https://platform.openai.com/api-keys
#
# Note: OpenAI supports both chat and embeddings with the same API key.
# The same API key is used for both chat and embeddings.
#
# Example:
# LLM_PROVIDER=openai
# LLM_API_KEY=sk-...
# LLM_DEFAULT_MODEL=gpt-4-turbo
# LLM_ORGANIZATION=org-...  # Optional

# -----------------------------------------------------------------------------
# Anthropic Claude Configuration
# -----------------------------------------------------------------------------
# Provider: anthropic
# Models: claude-3-5-sonnet-20241022, claude-3-opus-20240229, claude-3-sonnet-20240229
# Get API key: https://console.anthropic.com/account/keys
#
# Example:
# LLM_PROVIDER=anthropic
# LLM_API_KEY=sk-ant-...
# LLM_DEFAULT_MODEL=claude-3-5-sonnet-20241022

# -----------------------------------------------------------------------------
# Google Gemini Configuration
# -----------------------------------------------------------------------------
# Provider: google-gemini
# Chat Models: gemini-1.5-pro, gemini-1.5-flash, gemini-2.5-flash-lite
# Embedding Model: text-embedding-004 (768 dimensions, FREE as of 2024-2025)
# Get API key: https://makersuite.google.com/app/apikey
#
# Note: When LLM_PROVIDER is set to google-gemini, real vector embeddings
# will be automatically enabled for semantic search and memory features.
# The same API key is used for both chat and embeddings.
# If not configured, the system will fall back to mock embeddings.
#
# Configuration Priority:
# 1. Database configuration (tenant-specific or system-wide via LLM Config API)
# 2. Environment variables (these settings)
# 3. Mock embeddings (fallback)
#
# Example:
# LLM_PROVIDER=google-gemini
# LLM_API_KEY=AIza...
# LLM_DEFAULT_MODEL=gemini-1.5-pro

# -----------------------------------------------------------------------------
# Perplexity AI Configuration
# -----------------------------------------------------------------------------
# Provider: perplexity
# Models: llama-3.1-sonar-small-128k-online, llama-3.1-sonar-large-128k-online
# Get API key: https://www.perplexity.ai/settings/api
#
# Example:
# LLM_PROVIDER=perplexity
# LLM_API_KEY=pplx-...
# LLM_DEFAULT_MODEL=llama-3.1-sonar-small-128k-online

# -----------------------------------------------------------------------------
# Abacus.ai Configuration
# -----------------------------------------------------------------------------
# Provider: abacus-ai
# Models: Check Abacus.ai documentation
# Get API key: https://abacus.ai/
#
# Example:
# LLM_PROVIDER=abacus-ai
# LLM_API_KEY=...
# LLM_DEFAULT_MODEL=...
# LLM_BASE_URL=https://api.abacus.ai/v1  # Optional custom endpoint

# =============================================================================
# Vector Database (Future - for chat embeddings)
# =============================================================================

# Pinecone Configuration
# PINECONE_API_KEY=your-pinecone-api-key
# PINECONE_ENVIRONMENT=your-pinecone-environment
# PINECONE_INDEX=freetimechat-embeddings

# =============================================================================
# Monitoring & Analytics (Future)
# =============================================================================

# Sentry Error Tracking
# SENTRY_DSN=https://...@sentry.io/...
# SENTRY_ENVIRONMENT=development
# SENTRY_TRACES_SAMPLE_RATE=1.0

# =============================================================================
# Feature Flags
# =============================================================================

ENABLE_REGISTRATION=true
ENABLE_GOOGLE_AUTH=true
ENABLE_TWO_FACTOR=true
ENABLE_IMPERSONATION=true
ENABLE_EMAIL_NOTIFICATIONS=true
